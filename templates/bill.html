{% extends "base.html" %}
{% block title %}账单{% endblock %}
{% block head %}
    <style>
        img {
            float: right;
            width: 25px;
        }
    </style>
{% endblock %}
{% block body %}
    <div class="row">
        <div class="col"></div>
        <div class="col-8" style="background-color: white; margin: 20px">
            <h3 style="margin: 20px">账单</h3>
            <ul class="list-group" style="margin-bottom: 20px">
                {% for bill in bills %}
                    <li class="list-group-item">
                        {% if bill.zan == False %}
                            <img order="{{ bill.id }}" src="/static/images/zan/tozan.jpg">
                        {% else %}
                            <img order="{{ bill.id }}" src="/static/images/zan/zaned.jpg">
                        {% endif %}
                        {{ bill.food_name }}<p>{{ bill.food_price }}￥</p>
                        <small id="emailHelp" class="form-text text-muted"
                               style="text-align: right">{{ bill.order_date }}</small>
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col"></div>
    </div>
{% endblock %}
{% block script %}
    <script src="/static/js/jquery-3.6.0.js"></script>
    <script>
        $('img').click(function () {
            let orderId = $(this).attr('order')
            let self = $(this)
            $.ajax({
                type: "GET",
                url: "/zan/",
                data: {"order_id": orderId},
                success: function (resp) {
                    if (self.attr('src') === '/static/images/zan/zaned.jpg') {
                        self.attr('src', '/static/images/zan/tozan.jpg')
                    } else {
                        self.attr('src', '/static/images/zan/zaned.jpg')
                    }
                    console.log(resp)
                },
                error: function () {
                    alert("请求出错了")
                }
            })
        })
    </script>
{% endblock %}
